## 群公告

\#珠海多云管平台（开发环境）
https://172.16.48.49/cmp/#/login
admin/admin@admin.com
szgd/admin@admin.com

\# 多云管理平台（用户环境）
https://172.16.48.88/cmp/#/login
admin/admin@admin.com
szgd/admin@admin.com

\# GITLab仓库（公司）地址
https://gitlab.dg.com/dsywb/ds_develop/hangyeyewuxian/cmp-cloud

\# Swagger 地址
<gateway地址>/<应用Path>/doc.html (eg. sys文档地址：https://172.16.48.49/gateway/sys/doc.html#/home)
admin/Eshore@2024~

\#多云管理需求评审
时间：2024-4-22 16:30 
线上会议号：493 230 093
线下会议室：颐德1604
迭代链接：https://shujian.digitalgd.com.cn/monorepo/app-reqm/myProject/iteration?projectId=b9d72e084853405b946ed804e3ee9a7c&statusList=1&iterateId=5ece7f78758c4d42a4b4c8b0c44401a3https://doc.weixin.qq.com/sheet/e3_ACMAXAaOAEAloW2x0tMTZOZ6gSNbP?scode=AFYArwcHAAsUACn0p3ACMAXAaOAEA&version=4.1.22.6014&platform=win



## 基本



基座演示地址：https://xtbgtest.digitalgd.com.cn/sjgzwfw/jz/smp-business-support/#/login
admin/2X4hFtNa&Gy_v9

关于hita框架的介绍，这里有一些知行的文档：
https://zhixing.dg.com/#/editor?uuid=1fc3d71d-6598-4a13-b891-5ca9d61c0c38&doc_uuid=c79fe6d0-57f9-4263-b77e-f55f1f0c4deb

前端：
框架基本都是vue2+vue-router+vuex+tailwindcss。 组件库使用的是gmd-ui（http://developers.digitalgd.com.cn/gsds.v2/gmd-ui/docs/vue/introduce/）



测试环境：

https://172.16.48.49/cmp/#/login

### 多云管基础

管理员：szgd

普通用户（测试）：yuepang

#珠海多云管平台
https://172.16.48.49/cmp/#/login

密码已改为
admin/admin@admin.com

**testpy/Proxy@2024**（超级管理员）

testXiangzhou / Proxy@2024 (香洲区测试用户)



重置密码后，默认密码是q1w2e3R$tgB

1.多云管理基础应用

需要以下环境

node -v

v14.21.3

npm -v

6.14.18



| 1.多云管理基础应用          | https://gitlab.dg.com/dsywb/ds_develop/hangyeyewuxian/cmp-cloud/cmp-cloud-vue |
| --------------------------- | ------------------------------------------------------------ |
| 2.**表单&流程引擎应用**     | **https://gitlab.dg.com/dsywb/ds_develop/hangyeyewuxian/cmp-cloud/cloud-engine-support** |
| 3.**租户门户**              | **https://gitlab.dg.com/dsywb/ds_develop/hangyeyewuxian/cmp-cloud/cmp-work-portal** |
| 4.**引擎应用&租户门户基座** | https://gitlab.dg.com/dsywb/ds_develop/hangyeyewuxian/cmp-cloud/cloud-foundation-base |



2、3、4需要 node v10

cloud-foundation-base，把表单流程引擎和租户门户都放进基座的Packages文件夹，然后用lerna [最详细的 lerna 中文手册 - 掘金 (juejin.cn)](https://juejin.cn/post/7136925215388499998) 管理

```
nvs use v10

npm install lerna@3.22.1 -g

lerna bootstrap --force-local
```



租户门户、多云管理基础应用目录下需要：

```
git submodule init
git submodule update

然后切换submodule的main分支
```





三个web服务：

1. 多云管理基础应用

2. 表单&流程引擎——使用webcomponent嵌入1
3. 租户门户——1链接跳转到3



租户门户：流程引擎：

engine-support

mixin一下就可以引入

开发时，在engine-support开发，然后在多云管里面配置菜单即可



表单引擎engine-support，需要输入后缀，例如 [多云管理平台](http://localhost:8519/cloud-engine-support/#/workflow-new)

### 数字人大

用户组管理，参考数字人大：

[前端 · GitLab (dg.com)](https://gitlab.dg.com/dsywb/ds_develop/hangyeyewuxian/ds_pmo/platform/frontend)

admin 2X4hFtNa&Gy_v9

https://xtbgtest.digitalgd.com.cn/sjgzwfw/smp-business-support/#/login

https://xtbgtest.digitalgd.com.cn/sjgzwfw/work-portal/#/affair-new/all



## gateway

nginx转发，需要配一个映射，根据路径获取某个地址

nacos，则是后端写一个nacos地址，然后提供服务名，推送到nacos，nacos根据请求的路径前缀，发到不同服务（可能会随机到任何一台有该服务名的服务器）（要到nacos的，一般需要先给一个gateway前缀），一个服务：大概就是后端一个模块，里面可能会有好几种路径前缀，比如admin模块，可能支持sys、admin等开头的请求

前端请求：https://172.16.48.49/gateway，这样就会发到nacos，然后后面再根据前缀发到不同服务



本地玩nacos：

本地也可以启动nacos

本地后端启动gateway服务，和各种其他服务，配一下下面这里的nacos地址：

![image-20240530110826074](assets/image-20240530110826074.png)

服务起来之后，nacos就能看到对应的服务。

前端请求先到gateway服务，再到nacos，然后转发到各个服务器上（负载均衡）

nacos的配置重点：

4. lb:url：对应的是服务名，也就是后端各个服务的下面这里（lb就是load balance）：

![image-20240530110947504](assets/image-20240530110947504.png)

5. path：对应的就是前端/浏览器的前缀。识别到该前缀，就会转发到对应服务。



本地如果不用gateway，而是指定ip+一个端口，然后后端启动对应端口的服务，那前端只能转发到这个端口的服务，剩余的服务则无法转发（除非后端启动多个服务，然后针对不同的path，前端设置不同的端口）



## lerna

每次在engin-support里npm install之后，软链会掉，线上没有这个包，就要在foundation-base里lerna bootstrap一下。（可以学一下）

